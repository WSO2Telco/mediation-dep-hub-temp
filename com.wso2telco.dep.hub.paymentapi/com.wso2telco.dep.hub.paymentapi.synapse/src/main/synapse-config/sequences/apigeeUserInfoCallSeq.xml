<?xml version="1.0" encoding="UTF-8"?>
<sequence name="apigeeUserInfoCallSeq" onError="apigeeUserInfoCallErrorSeq" trace="disable" xmlns="http://ws.apache.org/ns/synapse">

    <log level="custom" xmlns="http://ws.apache.org/ns/synapse">
        <property name="################# AUICSE.LOG1"
                  value="HELLO WORLD!"/>
    </log>

    <property
            expression="get-property('registry','local:/Resource/celcomRefreshToken')"
            name="apigeeAccessToken" scope="default" type="STRING"/>


    <!-- pseudo code for logic to be implemented

    write separate sequence to get refresh and access tokens.
    write separate sequences for any repeating tasks

    if (accessToken.exists){
        callUserInfo();

        if(accessTokenExpired){
        update access token using refresh token

             set access token to registry;
        set refresh token to registry;

            if(refreshTokenExpired){
            update refresh token and auth token;

             set refresh token and auth token to registry;


            callSelf();
            }
        }
    }
    else{
        getAccessToken();
        getrefreshToken();

        set access token to registry;
        set refresh token to registry;

        callSelf();
    }
    -->

</sequence>
